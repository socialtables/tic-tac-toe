<html>
  <head>
    <title>Tic Tac Toe</title>
    <script src="http://fb.me/react-0.12.0.js"></script>
    <script src="http://fb.me/JSXTransformer-0.12.0.js"></script>
    <script src="http://code.jquery.com/jquery-1.10.0.min.js"></script>
    <link rel="stylesheet" href="t3cc.css">
  </head>
  <body>
    <div id="container"></div>
    <script type="text/jsx">
      /**
      * @jsx React.DOM
      */
        (function(){
            var Game = React.createClass({

              getInitialState: function() {
                return {
                  squares: [
                  " ", " ", " ",
                  " ", " ", " ",
                  " ", " ", " "
                  ],
                  clicks: 0
                };
              },

              handleGameClick: function(position) {
                this.checkWin();
                var numClicks = this.state.clicks +=1;
                this.setState({
                  clicks: numClicks
                });
              },

              reset: function() {
                this.setState(this.getInitialState());
              },

              checkWin: function() {
                var s = this.state.squares;
                var check = function(a,b,c) {
                  if(a === b && b === c && c == a && a === "X") {
                    alert("X wins!");
                  }
                  else if(a === b && b === c && c == a && a === "O") {
                    alert("O wins!");
                  }
                };
                check(s[0], s[1], s[2])
                check(s[3], s[4], s[5])
                check(s[6], s[7], s[8])
                check(s[0], s[3], s[6])
                check(s[1], s[4], s[7])
                check(s[2], s[5], s[8])
                check(s[0], s[4], s[8])
                check(s[2], s[4], s[6])
              },

              render: function() {
                  return <div>
                      <div id='game'>
                          {this.state.squares.map(function(letter,position){
                            return <Square status={letter} key={position} position={this.state.squares[position]} numClicks={this.state.clicks} handleGameClick={this.handleGameClick} />
                          }, this) }
                      </div>
                  <button onClick={this.reset}>New Game</button>
                  </div>;
              },
          });
            var Square = React.createClass({
              getInitialState: function() {
                return {played: false,
                  letter: " "
                };
              },
              handleClick: function() {
                if(this.state.played === false) {
                  var letter = this.props.numClicks%2 ? "O" : "X";
                  this.props.handleGameClick(this.props.status, this.props.position);
                  this.setState({played: !this.state.played,
                    letter: letter
                  });
                }
              },
              render: function() {
                return (
                  <div onClick={this.handleClick} className="square">{this.state.letter}</div>
                  );
              }
            })
            React.render(
                <Game />,
                document.getElementById('container')
            );
        })();
    </script>
  </body>
</html>