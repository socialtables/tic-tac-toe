<html>
  <head>
    <title>Tic Tac Toe</title>
    <script src="http://fb.me/react-0.12.0.js"></script>
    <script src="http://fb.me/JSXTransformer-0.12.0.js"></script>
    <script src="http://code.jquery.com/jquery-1.10.0.min.js"></script>
    <link rel="stylesheet" href="t3cc.css">
  </head>
  <body>
    <div id="container"></div>
    <script type="text/jsx">
      /**
      * @jsx React.DOM
      */
        (function(){
            var Game = React.createClass({

              getInitialState: function() {
                return {
                  squares: [
                  " ", " ", " ",
                  " ", " ", " ",
                  " ", " ", " "
                  ],
                  clicks: 0
                };
              },

              checkWin: function() {
                var s1 = ($('.square:eq(0)').html());
                var s2 = ($('.square:eq(1)').html());
                var s3 = ($('.square:eq(2)').html());
                var s4 = ($('.square:eq(3)').html());
                var s5 = ($('.square:eq(4)').html());
                var s6 = ($('.square:eq(5)').html());
                var s7 = ($('.square:eq(6)').html());
                var s8 = ($('.square:eq(7)').html());
                var s9 = ($('.square:eq(8)').html());

                var check = function(a, b, c) {
                  if(a === b && b === c && c === a && a === "X") {
                    ($('#win_clear')).append("X wins!");
                  }
                  else if(a === b && b === c && c === a && a === "O") {
                    ($('#win_clear')).append("O wins!");
                  }
                }
                check(s1, s2, s3);
                check(s4, s5, s6);
                check(s7, s8, s9);
                check(s1, s4, s7);
                check(s2, s5, s8);
                check(s3, s6, s9);
                check(s1, s5, s9);
                check(s3, s5, s7);
              },

              handleGameClick: function(position) {
                var numClicks = this.state.clicks +=1;
                this.setState({
                  clicks: numClicks
                });
                this.checkWin();
              },

              reset: function() {
                this.state.squares.forEach(function(){
                  ($('.square').empty());
                })
              },

              render: function() {
                  return <div>
                      <div id='game'>
                          {this.state.squares.map(function(letter,position){
                            return <Square status={letter} key={position} position={this.state.squares[position]} numClicks={this.state.clicks} handleGameClick={this.handleGameClick} />
                          }, this) }
                      </div>
                    <div id="win_clear">
                      <button onClick={this.reset}>New Game</button>
                    </div>
                  </div>;
              },
          });
            var Square = React.createClass({
              getInitialState: function() {
                return {played: false,
                  letter: " "
                };
              },

              handleClick: function() {
                if(this.state.played === false) {
                  var letter = this.props.numClicks%2 ? "O" : "X";
                  this.props.handleGameClick(this.props.status, this.props.position);
                  this.setState({played: !this.state.played,
                    letter: letter
                  });
                }
              },

              render: function() {
                return (
                  <div onClick={this.handleClick} className="square">{this.state.letter}</div>
                  );
              }
            })

            React.render(
                <Game />,
                document.getElementById('container')
            );
        })();
    </script>
  </body>
</html>